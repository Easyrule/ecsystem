<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EasyJob</title>
    <link rel="stylesheet" href="pay.css" type="text/css">
    <link rel="stylesheet" href="verificationC.css">

    <script defer src="verificationC.js"></script>
    <script defer src="face-api.min.js"></script>

    

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>

    <script src="https://www.gstatic.com/firebasejs/7.2.0/firebase-app.js">
    </script>

    <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>

    <style>
        th {
            color: whitesmoke;
            font-weight: 300;
        }
    </style>

</head>

<body>
    <nav>
        <input type="checkbox" id="check">
        <label for="check" class="checkbtn">
            <i class="fas fa-bars"></i>
        </label>
        <!-- <label><img src="logo.png"></label> -->
        <label class="logo"><img src="logo.png">EasyJob</label>
        <ul>
            <li><a style="color:black;">Home</a></li>
            <div class="dropdown">
                <button class="dropbtn" id="userlink"></button>
                <div class="dropdown-content">
                    <a href="Add.html">Add Job Ads</a>
                    <a href="employerProfile.html">Profile</a>
                    <a href="JobPage.html">Job Page</a>
                    <a href="payment.html">Payment</a>
                </div>
            </div>
            <li><a style="text-decoration: none;" id="signoutlink">Sign Out</a></li>
        </ul>
    </nav>

    <!--Home Section-->
    <section>


        <div class="contentarea">
            <h1>
                Using Javascript to capture Photo
            </h1>
            <div class="camera">
                <video id="video">Video stream not available.</video>
            </div>
            <div><button id="startbutton">Take photo</button></div>
            <canvas id="canvas"></canvas>
            <div class="output">
                <img id="photo" alt="The screen capture will appear in this box.">
            </div>
        </div>

        <!-- cuba tengok hat ni -->





        <!-- <video id="webcamvid" autoplay muted>Video stream not available.</video>

        <div>
                      
            <button id="startbutton">Take photo</button>
        </div>
        

        <div class="output">
            <img id="myphoto" alt="The screen capture will appear in this box."> <label id="loadingbar"></label>

        </div> -->



        


        <!-- <div class="container" data-aos="fade-up">

            <div class="row">
              <div class="col-md-6 d-flex align-items-stretch">
                <div class="card">
                  <div class="card-img">
                    
                    <video id="video">Video stream not available.</video>
                    
                  </div>

                  <div>
                      
                    <button id="startbutton">Take photo</button>
                </div>
                  
                </div>
              </div>
              <div class="col-md-6 d-flex align-items-stretch">
                <div class="card">
                  <div class="card-img">
                    <canvas id="canvas">
                    
                    </canvas>
                    <div class="output">
                        <img id="myphoto" alt="The screen capture will appear in this box."> <label id="loadingbar"></label>
                        <label>Insert image name</label> <input type = "text" id = "namabox" > <label id="pathimg"></label> <br><br>
                        <input class="btn btn-primary" type="submit" value="Submit">
                        <button id="uploadtofirebase">Upload</button>
                    </div>
                  </div>
                  
                </div>
    
              </div>
            </div>
    
          </div> -->





<!-- <script>


(function() {

var width = 320; // We will scale the photo width to this
var height = 0; // This will be computed based on the input stream

var streaming = false;

var video = null;
var canvas = null;
var photo = null;
var startbutton = null;

function startup() {
    video = document.getElementById('video');
    canvas = document.getElementById('canvas');
    photo = document.getElementById('myphoto');
    startbutton = document.getElementById('startbutton');

    navigator.mediaDevices.getUserMedia({
            video: true,
            audio: false
        })
        .then(function(stream) {
            video.srcObject = stream;
            video.play();
        })
        .catch(function(err) {
            console.log("An error occurred: " + err);
        });

    video.addEventListener('canplay', function(ev) {
        if (!streaming) {
            height = video.videoHeight / (video.videoWidth / width);

            if (isNaN(height)) {
                height = width / (4 / 3);
            }

            video.setAttribute('width', width);
            video.setAttribute('height', height);
            canvas.setAttribute('width', width);
            canvas.setAttribute('height', height);
            streaming = true;
        }
    }, false);

    startbutton.addEventListener('click', function(ev) {
        takepicture();
        ev.preventDefault();
    }, false);

    clearphoto();
}


function clearphoto() {
    var context = canvas.getContext('2d');
    context.fillStyle = "#AAA";
    context.fillRect(0, 0, canvas.width, canvas.height);

    var data = canvas.toDataURL('image/png');
    photo.setAttribute('src', data);
}

function takepicture() {
    var context = canvas.getContext('2d');
    if (width && height) {
        canvas.width = width;
        canvas.height = height;
        context.drawImage(video, 0, 0, width, height);

        var data = canvas.toDataURL('image/png');
        photo.setAttribute('src', data);

        console.log(photo);


        





    } else {
        clearphoto();
    }
}

window.addEventListener('load', startup, false);
})();




    </script> 


    <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB9tp7nBfMxsqBqgyQsCXE8gDhx7BSAaIk", 
      authDomain: "e-cs-8e95e.firebaseapp.com",
      projectId: "e-cs-8e95e",
      storageBucket: "e-cs-8e95e.appspot.com",
      messagingSenderId: "648134779146",
      appId: "1:648134779146:web:c48d9e26dfeaa1d04d9af3"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);

    import {
        dapatkanstorage, ref as sRef, uploadBytesResumablee, dapatDownloadUrl
    } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-storage.js";

    var myphoto = document.getElementById("myphoto");
    var progress = document.getElementById("loadingbar");
    var uploadBtn = document.getElementById("uploadtofirebase");
    var namabox = document.getElementById("namabox");
    

    async function UploadProcess(){
        var ImgtoUpload = files [0];
        var namaimage = namabox + ".png" ;

        const metaData ={
            contentType: ImgtoUpload.type
        }

        const storage = dapatkanstorage;

        const storageRef = sRef(storage, "gambaq/" + namaimage);

        const UploadTask = uploadBytesResumablee(storageRef, ImgtoUpload, metaData);

        UploadTask.on('state-changed', (snapshot)=>{
            var progress = (snapshot.bytes)
        });


    }
    




  </script> -->



       
    </section>


    
    
    







    <script>

        let userlink = document.getElementById('userlink');
        let signoutlink = document.getElementById('signoutlink');
        var currentUser = null;

        function getUsername() {
            let keepLoggedIn = localStorage.getItem("keepLoggedIn");

            if (keepLoggedIn == "yes") {
                currentUser = JSON.parse(localStorage.getItem('user'));
            }

            else {
                currentUser = JSON.parse(sessionStorage.getItem('user'));
            }
        }

        function Signout() {
            sessionStorage.removeItem('user');
            localStorage.removeItem('user');
            localStorage.removeItem('keepLoggedIn');
            window.location = "homeEmployer.html";
        }

        window.onload = function () {
            getUsername();
            if (currentUser == null) {
                userlink.innerText = "Create New Account";
                userlink.href = "register.html";
                signoutlink.innerText = "Login";
                signoutlink.href = "login.html";
            }

            else {
                userlink.innerText = currentUser.username;
                userlink.href = "#";
                signoutlink.innerText = "Sign Out";
                signoutlink.href = "javascript:Signout()";


            }
        }



       





function myFunction() {
    let x = document.getElementById("jid").value;
    let y = document.getElementById("dt").value;
    let z = document.getElementById("tp").value  ;

    var nameu = userlink.innerText;
    var messagesRef = firebase.database().ref('PaymentbyEmployer').child(y).child(x);
    
    // Get the value of the input field with id="numb"
    

  
    
    var pass , pass1, pass2;
  
    // If x is Not a Number or less than one or greater than 10
    let text;
    if (x != "") {
      text = "";
      pass =1;
    } else {
      text = "This must be filled";
      pass =2;
    }
  
    let text1;
    if (y != "") {
      text1 = "";
      pass1 =1;
    } else {
      text1 = "This must be filled";
      pass1 =2;
    }
  
    let text2;
    if (z != "" ) {
      text2 = "";
      pass2 =1;
    } else {
      text2 = "This must be filled";
      pass2 =2;
    }
  
    
  
  
  
  
  
    document.getElementById("dis").innerHTML = text;
    document.getElementById("dis1").innerHTML = text1;
    document.getElementById("dis2").innerHTML = text2;
 
    

    

  
    if(pass == 1 && pass1 == 1 && pass2 == 1 ){
      let jobpaid = {JobID:x, Amount:z,Employer: nameu, Status:"Paid" };

      

      
  
     //document.getElementById("dis1").innerHTML = "cubaaaaa";
     //document.getElementById('registerform').reset();
  
     //saveMessage(y,z,jobseeker);
  
     //nextp();
      
     //document.getElementById("dis2").innerHTML = "cubaaaaa2"; 
     
     
     // var registrationref = firebase.au
     
    
    //var newMessageRef = messagesRef.push();
    messagesRef.set(jobpaid);

     
  
     //document.getElementById("dis3").innerHTML = "cubaaaaa3";
     alert("Succefully Process");
      
  
  
      //
    }

   
    
  
   
  } 




    </script>























    

</body>

</html>